"use strict";function counter(t,e,o){if(flag){flag=!1;var n={day:(new Date).toDateString(),ips:[getIp.getClientIp(t)]};mongo_1.db.getIPsByDay(n.day).then(function(t){if(t)return t;mongo_1.db.addIP(n),flag=!0}).then(function(t){for(var e=0,o=t.ips;e<o.length;e++){if(o[e]==n.ips[0])throw new Error("nothing to do")}mongo_1.db.pushIP(n),flag=!0}).catch(function(t){flag=!0})}o()}exports.__esModule=!0;var getIp=require("request-ip"),mongo_1=require("./mongo"),flag=!0;exports.counter=counter;